(window.webpackJsonpcm_front=window.webpackJsonpcm_front||[]).push([[0],[,,,,,function(e,t,n){e.exports=n.p+"static/media/VIPAlarm.d3e7bccd.mp3"},function(e,t,n){e.exports=n(25)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),i=n.n(c),o=(n(11),n(1)),l=n(2),s=(n(12),n(13),function(e){var t=e.agent,n=e.size,a=e.censor,c=new Date(1e3*t.Duration).toISOString().substr(11,8),i="biggest"===n?30:12,o=a?t.AgentFirstName:t.AgentName.substr(0,i);return r.a.createElement("div",{className:"agent",id:t.status},r.a.createElement("div",{className:"agent-name"},o),r.a.createElement("div",{className:"agent-status"},c," ",t.Reason))}),u=function(e){var t,n=e.agents,a=e.censor,c=(t=n.length)<5?"biggest":t<11?"big":"normal",i=n.map(function(e,t){return r.a.createElement(s,{key:t,agent:e,size:c,censor:a})});return r.a.createElement("div",{className:"agent-grid ".concat(c),id:"content"},i)},m=(n(14),function(e){var t=e.idStatus,n=e.idNumber,a=e.status,c=e.count;return r.a.createElement("div",{className:"agent-count"},r.a.createElement("div",{className:"status",id:t},a),r.a.createElement("div",{className:"number",id:n},c))}),d=function(e){var t=e.statusCount;return r.a.createElement("div",{className:"agent-header"},r.a.createElement(m,{idStatus:"center",idNumber:"left",status:"FREE: ",count:t.free}),r.a.createElement(m,{idStatus:"center",idNumber:"left",status:"CALL: ",count:t.call}),r.a.createElement(m,{idStatus:"center",idNumber:"left",status:"BUSY: ",count:t.busy}),r.a.createElement(m,{idStatus:"center",idNumber:"left",status:"TOTAL: ",count:t.total}))},f=function(e){var t=e.agents,n=e.censor,a=["Login","Sis\xe4\xe4nkirjaus"],c=["J\xc4LKIKIRJAUS","PUHELU (Sis\xe4\xe4n)","PUHELU (Ulos)","S\xc4HK\xd6POSTI (Sis\xe4\xe4n)","S\xc4HK\xd6POSTI (Ulos)","WRAPUP TIME","CALL (In)","CALL (Out)"],i=t.reduce(function(e,t){return e.total++,a.includes(t.Reason)?(e.free++,t.status="free",e):c.includes(t.Reason)?(e.call++,t.status="call",e):(t.status="busy",e.busy++,e)},{free:0,call:0,busy:0,total:0}),o=0!==t.length?"":"NO AGENTS ONLINE";return r.a.createElement("div",{className:"agent-section"},r.a.createElement("div",{className:"agent-container"},r.a.createElement(d,{statusCount:i}),r.a.createElement("div",{className:"agent-list"},r.a.createElement(u,{agents:t,censor:n}),r.a.createElement("div",{className:"agent-background"},o))))},v=[362],E=(n(15),n(16),function(e){var t=e.item,n=t.MaxQueueTime,a=Math.floor(n/3600),c=Math.floor(n/60)-60*a,i=n-60*c-3600*a,o="PBX"===t.ContactType?function(e){return e<120?"green":e<600?"yellow":"red"}(n):"email";return r.a.createElement("div",{className:"queue-row"},r.a.createElement("div",{className:"service-name"},t.ServiceName),r.a.createElement("div",{className:"service-channel",id:o},"PBX"===t.ContactType?"CALL":t.ContactType),r.a.createElement("div",{className:"service-length",id:o},t.QueueLength),r.a.createElement("div",{className:"service-time",id:o},a<10?"0".concat(a):a,":",c<10?"0".concat(c):c,":",i<10?"0".concat(i):i))}),g=(n(17),n(5)),S=n.n(g),N=function(e){var t=e.startTime,n=Object(a.useState)(t),c=Object(o.a)(n,2),i=c[0],l=c[1];if(Object(a.useEffect)(function(){setTimeout(function(){l(i+1)},1e3)},[i]),i>20){var s=new Date(1e3*(i-20)).toISOString().substr(11,8);return r.a.createElement("div",{className:"timer red"},"-",s)}var u=new Date(1e3*(20-i)).toISOString().substr(11,8);return r.a.createElement("div",{className:"timer blue"},u)},b=function(e){var t=e.count,n=e.callShown,c=Object(a.useState)("alarm-yellow"),i=Object(o.a)(c,2),l=i[0],s=i[1],u="alarm-yellow"!==l?"alarm-yellow":"alarm-white";Object(a.useEffect)(function(){setTimeout(function(){s(u)},1e3)},[u]);var m=t+n.QueueLength;m>1&&"VIP CALLS: ".concat(m);return r.a.createElement("div",{className:"queue-alarm-modal ".concat(l)},r.a.createElement("audio",{src:S.a,autoPlay:!0,loop:!0}),r.a.createElement("div",null,"VIP CALL"),r.a.createElement("div",{className:"call-name"},n.ServiceName),r.a.createElement(N,{startTime:n.MaxQueueTime}))},h=function(e){var t=e.vipCalls;if(0===t.length)return null;var n=t.length,a=t[0];return r.a.createElement(b,{count:n,callShown:a})},p=(n(18),function(){return r.a.createElement("div",{className:"queue-header"},r.a.createElement("div",{className:"header-name"},"SERVICE NAME"),r.a.createElement("div",{className:"header-channel"},"TYPE"),r.a.createElement("div",{className:"header-length"},"#"),r.a.createElement("div",{className:"header-time"},"WAIT"))}),A=function(e,t){return e.MaxQueueTime<t.MaxQueueTime?1:e.MaxQueueTime>t.MaxQueueTime?-1:0},O=function(e){return e.map(function(e,t){return r.a.createElement(E,{key:t,item:e})})},T=function(e){var t=e.queue,n=[],a=[];t&&(n=t.filter(function(e){return"PBX"!==e.ContactType}).sort(A),a=t.filter(function(e){return"PBX"===e.ContactType}).sort(A));var c=0!==n.length?"":"NO EMAILS",i=0!==a.length?"":"NO CALLS",o=a.filter(function(e){return v.includes(e.ServiceId)});return r.a.createElement("div",{className:"queue-section"},r.a.createElement("div",{className:"queue-container"},r.a.createElement(p,null),r.a.createElement("div",{className:"call-list"},r.a.createElement("div",{className:"list-background "},r.a.createElement("h1",null,i)),r.a.createElement("div",null,O(a))),r.a.createElement("div",{className:"email-list"},r.a.createElement("div",{className:"list-background "},r.a.createElement("h1",null,c)),r.a.createElement("div",null,O(n))),r.a.createElement(h,{vipCalls:o})))},I=function(e,t){var n=e.reduce(function(e,n){return t.includes(n.ServiceId)&&(e.Answered+=n.ProcessedPieces,e.Received+=n.ContactsPieces),e},{Answered:0,Received:0}),a="".concat(n.Answered,"/").concat(n.Received),r="".concat(Math.round(n.Answered/n.Received*100)," %");return{stats:a,ratio:"NaN %"!==r?r:"100 %"}},L=function(e,t,n){var a=function(e){var t="ALL TEAMS"!==e?"ALL ".concat(e):"ALL TEAMS";return n.find(function(e){return e.AgentName===t}).ServiceIds};if(t.includes("ALL TEAMS"))return I(e,a("ALL TEAMS"));var r=[];return t.forEach(function(e){var t=a(e);r.push.apply(r,Object(l.a)(t))}),I(e,r)},w=I,P=(n(19),function(e){var t=e.type,n=e.stats;return r.a.createElement("div",{className:"stats-count"},r.a.createElement("div",null,t,": ",n.stats),r.a.createElement("div",null,n.ratio))}),C=function(e){e.type;var t=e.name,n=e.statsPBX,a=e.statsEmail;return r.a.createElement("div",{className:"stats-row"},r.a.createElement("div",null,t),r.a.createElement(P,{type:"Calls",stats:n}),r.a.createElement(P,{type:"Emails",stats:a}))},j=function(e){var t=e.activeTeamProfiles,n=e.activeTeam,a=e.teams,c=e.activeProfileId,i=e.report,o=e.censor,s="NONE",u="0/0",m="0/0";if(0!==a.length&&i&&0!==i.reportPBX.length&&(0!==t.length&&(u=L(i.reportPBX,n,t),m=L(i.reportEmail,n,t),s=n.length>1?"".concat(n[0]," +").concat(n.length-1):n[0]),0!==c.length)){var d=a.find(function(e){return"ALL TEAMS"===e.TeamName}).Profiles.filter(function(e){return c.includes(e.AgentId)}),f=d.reduce(function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(t.ServiceIds))},[]);w(i.reportPBX,f),w(i.reportEmail,f);var v=o?d[0].AgentFirstName:d[0].AgentName;d.length>1?"".concat(v," +").concat(d.length-1):v}return r.a.createElement("div",{className:"statistics"},r.a.createElement(C,{type:"Team",name:s,statsPBX:u,statsEmail:m}))},y=(n(20),function(e){var t=e.list,n=e.column,c=e.type,i=e.header,l=Object(a.useState)(""),s=Object(o.a)(l,2),u=s[0],m=s[1],d=t?t.filter(function(e){return e.props.children.toLowerCase().includes(u.toLowerCase())}):t,f={gridColumn:n};return r.a.createElement("div",{className:"modal-list",style:f},r.a.createElement("div",{className:"modal-title"},r.a.createElement("h3",null,c),r.a.createElement("h3",null,i),"Search: ",r.a.createElement("input",{value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"modal-search"},d))}),M=function(e){var t=e.activeTeamProfiles,n=e.activeTeam,a=e.teamsList,c=e.changeTeam,i=e.activeProfileId,o=e.changeProfile,l=e.showModal,s=0===a.length?[]:a.find(function(e){return"ALL TEAMS"===e.TeamName}).Profiles,u=0===s.length?[]:s.filter(function(e){return i.includes(e.AgentId)}),m=a?a.map(function(e,t){return r.a.createElement("button",{id:(a=e.TeamName,n.includes(a)?"Selected":"Unselected"),key:t,onClick:function(){return c(e.TeamName)}},e.TeamName);var a}):[],d=function(e){return i.includes(e.AgentId)?"Selected":"Unselected"},f=function(e,t){return e.sort(function(e,n){return t.includes(e.AgentId)?-1:t.includes(n.AgentId)?1:"ALL TEAMS"===e.AgentName?-1:"ALL TEAMS"===n.AgentName?1:e.AgentName<n.AgentName?-1:1})}(t,i).map(function(e,t){return r.a.createElement("button",{id:d(e),key:t,onClick:function(){return o(e.AgentId)}},e.AgentName)}),v=l?"show":"hide",E=0===n.length?"NONE":n.length>1?"".concat(n[0]," +").concat(n.length-1):n[0],g=0===u.length?"NONE":u.length>1?"".concat(u[0].AgentName," +").concat(u.length):u[0].AgentName;return r.a.createElement("div",{className:"modal-box",id:v},r.a.createElement(y,{list:m,column:1,type:"TEAM:",header:E}),r.a.createElement(y,{list:f,column:2,type:"PROFILE:",header:g}))},R=(n(21),function(e){var t=e.showHelp?"show":"hide",n=window.localStorage.getItem("serverVersion");return r.a.createElement("div",{className:"help-modal",id:t},r.a.createElement("p",null,"Help unavailable at the moment.",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),"If you have suggestions or encounter errors/problems contact:",r.a.createElement("br",null),r.a.createElement("br",null),"Email oliver.martikainen@cgi.com, Subject: QueueMonitor",r.a.createElement("br",null),"or",r.a.createElement("br",null),"Email markus.ruotsalainen@cgi.com",r.a.createElement("br",null),r.a.createElement("br",null),"Next to help button there is a small circle that can be green, yellow or red. Green means connection is ok. Yellow means browser is not connected to server - either you need to change your connection or the server is down. Red means server has no connection to database - nothing you can do - contact admin.",r.a.createElement("br",null),r.a.createElement("br",null),"version: ",n))}),U=(n(22),function(e){var t=e.error,n=200===t.status?"green":503===t.status?"yellow":"red",a="",c="Connection normal";return 200!==t.status&&(a="CONNECTION PROBLEMS",503===t.status&&(c="Server connection problems!"),502===t.status&&(c="Database connection problems!")),r.a.createElement("div",{className:"error-board"},r.a.createElement("div",{className:"error-status"},r.a.createElement("button",{id:n}),r.a.createElement("div",{className:"error-explain",id:"message".concat(n)},"Connection status: ",t.status,r.a.createElement("br",null),c)),r.a.createElement("div",{className:"error-message",id:"message".concat(n)},a))}),k=(n(23),function(e){var t=e.OptItems,n=Object(a.useState)(!1),c=Object(o.a)(n,2),i=c[0],s=c[1],u=Object(a.useState)(!1),m=Object(o.a)(u,2),d=m[0],f=m[1],v=t.censor?"On":"OFF",E=i?"Selected":"Unselected",g=d?"Selected":"Unselected",S=t.censor?"Selected":"Unselected",N=function(e,t){var n=[];return e.forEach(function(e){var a;n.push.apply(n,Object(l.a)((a=e,0===t.length?[]:t.find(function(e){return e.TeamName===a}).Profiles)))}),n}(t.activeTeam,t.teams);return r.a.createElement("div",{className:"options-section"},r.a.createElement(M,{activeTeamProfiles:N,activeTeam:t.activeTeam,teamsList:t.teams,changeTeam:t.changeTeam,activeProfileId:t.activeProfileId,changeProfile:t.changeProfile,showModal:i}),r.a.createElement(R,{showHelp:d}),r.a.createElement("div",{className:"buttons-container"},r.a.createElement("button",{id:E,onClick:function(){return s(!i)}},"CHOOSE FILTERS"),r.a.createElement("button",{id:"Unselected",onClick:function(){t.changeTeam("")}},"REMOVE FILTERS"),r.a.createElement("button",{id:S,onClick:t.setCensor},"CENSOR: ",v),r.a.createElement("button",{id:g,onClick:function(){return f(!d)}},"HELP"),r.a.createElement(U,{error:t.connectionStatus})),r.a.createElement(j,{activeTeamProfiles:N,activeTeam:t.activeTeam,teams:t.teams,activeProfileId:t.activeProfileId,report:t.report,censor:t.censor}))}),D="".concat("./api","/push"),B=function(){return new EventSource("".concat(D,"/dataUpdates"))},Q=function(){return new EventSource("".concat(D,"/teamUpdates"))},x=function(e){var t=function(e){return e[0]},n=[];return e.forEach(function(e){var a={ServiceId:e.ServiceId,ServiceName:t(e.ServiceName),ChannelId:e.ChannelId,ChannelName:t(e.ChannelName),ContactType:e.ContactType,Direction:e.Direction,MaxQueueTime:e.MaxQueueTime,QueueLength:e.QueueLength};n.push(a)}),n},F=function(e,t){return e.forEach(function(e){var n=t.find(function(t){return t.AgentId===e.AgentId});e.AgentFirstName=n.AgentFirstName}),e},X=(n(24),function(){var e=window.localStorage.getItem("activeProfileId");return e?e.split(",").map(function(e){return parseInt(e)}):[]}),V=function(){var e=window.localStorage.getItem("activeTeam");return e?e.split(","):[]},H=function(){var e=Object(a.useState)(V),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(X),s=Object(o.a)(i,2),u=s[0],m=s[1],d=Object(a.useState)(!1),v=Object(o.a)(d,2),E=v[0],g=v[1],S=Object(a.useState)([]),N=Object(o.a)(S,2),b=N[0],h=N[1],p=Object(a.useState)([]),A=Object(o.a)(p,2),O=A[0],I=A[1],L=Object(a.useState)([]),w=Object(o.a)(L,2),P=w[0],C=w[1],j=Object(a.useState)(""),y=Object(o.a)(j,2),M=y[0],R=y[1],U=Object(a.useState)({status:200,errorStart:""}),D=Object(o.a)(U,2),H=D[0],q=D[1],J=Object(a.useState)(200),K=Object(o.a)(J,2),W=K[0],Y=K[1],z=function(e){var t=function(e){window.localStorage.setItem("activeProfileId",e.toString()),m(e)};if(""!==e){if(u.includes(1))return 1===e?void t([]):void t([e]);if(1!==e)t(u.includes(e)?u.filter(function(t){return t!==e}):[].concat(Object(l.a)(u),[e]));else t([e])}else t([])};Object(a.useEffect)(function(){!function(e,t,n){t.status!==e&&n({status:e,time:(new Date).toISOString()})}(W,H,q)},[W,H]),Object(a.useEffect)(function(){!function e(t){var n=Q();n.onopen=function(e){var t=(new Date).toISOString().substr(11,8);console.log("teamUpdates OPEN:",t)},n.onerror=function(a){var r=(new Date).toISOString().substr(11,8);console.log("teamUpdates ERROR: ",r),n.close(),setTimeout(function(){return e(t)},1e4)},n.onmessage=function(e){var n=JSON.parse(e.data);if(200===n.status){var a=window.localStorage.getItem("serverVersion");a&&a!==n.serverVersion&&window.location.reload(!0),window.localStorage.setItem("serverVersion",n.serverVersion),t(n.teams)}else{var r=(new Date).toISOString().substr(11,8);console.log("TEAM UPDATE FAILED",n.status,r)}}}(C),function e(t,n,a,r){var c=B();c.onopen=function(e){var t=(new Date).toISOString().substr(11,8);console.log("dataUpdates OPEN:",t)},c.onerror=function(i){var o=(new Date).toISOString().substr(11,8);console.log("dataUpdates ERROR: ",o),r(503),c.close(),setTimeout(function(){return e(t,n,a,r)},1e4)},c.onmessage=function(e){var c=JSON.parse(e.data);if(200!==c.status){var i=(new Date).toISOString().substr(11,8);return r(c.status),void console.log("TEAM UPDATE FAILED",c.status,i)}var o={reportPBX:c.reportPBX,reportEmail:c.reportEmail};t(c.queue),n(c.agentsOnline),a(o),r(200)}}(h,I,R,Y)},[]);var G=function(e,t,n,a){if(!t||0===t.length||0===e.length||0===a.length)return[];try{var r=(e.includes("ALL TEAMS")?t:t.filter(function(t){return e.includes(t.Team)})).sort(function(e,t){return e.AgentName<t.AgentName?-1:1});if(n){var c=a.find(function(e){return"ALL TEAMS"===e.TeamName}).Profiles;return F(r,c)}return r}catch(i){return console.log("a",e,"b",t,"c",n,"d",a),console.error("Wild AgentSorting error",i),[]}}(n,O,E,P),_=function(e,t,n,a){try{if(0===t.length||0===e.length||0===n.length)return[];var r=n.find(function(e){return"ALL TEAMS"===e.TeamName}).Profiles.filter(function(e){return t.includes(e.AgentId)}),c=r.reduce(function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(t.ServiceIds))},[]),i=e.filter(function(e){return c.includes(e.ServiceId)});return a?x(i):i}catch(o){return console.error("QueueProfile error:",t,o),e}}(b,u,P,E),Z={activeTeam:n,teams:P,changeTeam:function(e){var t=function(e){window.localStorage.setItem("activeTeam",e.toString()),c(e)};if(""===e)return z(""),void t([]);if(n.includes("ALL TEAMS"))return"ALL TEAMS"===e?void t([]):void t([e]);"ALL TEAMS"!==e?t(n.includes(e)?n.filter(function(t){return t!==e}):[].concat(Object(l.a)(n),[e])):t([e])},activeProfileId:u,changeProfile:z,censor:E,setCensor:function(){return g(!E)},report:M,connectionStatus:H};return r.a.createElement("div",{className:"main"},r.a.createElement(T,{queue:_}),r.a.createElement(f,{agents:G,censor:E}),r.a.createElement(k,{OptItems:Z}))};i.a.render(r.a.createElement(H,null),document.getElementById("root"))}],[[6,1,2]]]);
//# sourceMappingURL=main.0ca52717.chunk.js.map